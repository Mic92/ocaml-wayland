<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Wayland__Msg (wayland.Wayland__Msg)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">wayland</a> &#x00BB; Wayland__Msg</nav><h1>Module <code>Wayland__Msg</code></h1><nav class="toc"><ul><li><a href="#reading-messages">Reading messages</a></li><li><a href="#generating-messages">Generating messages</a></li></ul></nav></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>('a, 'rw) t</span></code><code> <span class="keyword">constraint</span> <span class="type-var">'rw</span> = <span>[&lt; `R <span>| `W</span> ]</span></code></dt><dd><p>An <code>('a, 'rw) t</code> is a message for the <code>'a</code> interface. <code>'rw</code> is <code>`R</code> for an incoming message to be read, or <code>`W</code> for an outgoing message to be written.</p></dd></dl><dl><dt class="spec value" id="val-pp_args"><a href="#val-pp_args" class="anchor"></a><code><span class="keyword">val</span> pp_args : <span><a href="../Wayland/Metadata/index.html#type-arg">Wayland.Metadata.arg</a> list</span> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> Fmt.t</span></code></dt><dd><p><code>pp_args types</code> is a formatter for messages with argument types <code>types</code>.</p></dd></dl><section><header><h3 id="reading-messages"><a href="#reading-messages" class="anchor"></a>Reading messages</h3></header><dl><dt class="spec value" id="val-parse"><a href="#val-parse" class="anchor"></a><code><span class="keyword">val</span> parse : <span>fds:<span>Unix.file_descr Stdlib.Queue.t</span></span> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'a</span>, <span>[ `R ]</span>)</span> <a href="index.html#type-t">t</a></span> option</span></code></dt><dd><p><code>parse ~fds buf</code> returns the first message in <code>buf</code>, if any. When <code>get_fd</code> is called, it will take one from <code>fds</code>. Returns <code>None</code> if <code>buf</code> does not contain a complete message.</p></dd></dl><dl><dt class="spec value" id="val-obj"><a href="#val-obj" class="anchor"></a><code><span class="keyword">val</span> obj : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> int32</code></dt><dd><p><code>obj t</code> is the object ID in the message header.</p></dd></dl><dl><dt class="spec value" id="val-op"><a href="#val-op" class="anchor"></a><code><span class="keyword">val</span> op : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> int</code></dt><dd><p><code>op t</code> is the operation ID in the message header.</p></dd></dl><dl><dt class="spec value" id="val-length"><a href="#val-length" class="anchor"></a><code><span class="keyword">val</span> length : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> int</code></dt><dd><p><code>length t</code> is the total size of the message (including any space for arguments not yet added).</p></dd></dl><dl><dt class="spec value" id="val-get_int"><a href="#val-get_int" class="anchor"></a><code><span class="keyword">val</span> get_int : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> int32</code></dt><dd><p><code>get_int t</code> returns the next argument (which must be an integer) from <code>t</code> and advances the next-argument pointer.</p></dd></dl><dl><dt class="spec value" id="val-get_string"><a href="#val-get_string" class="anchor"></a><code><span class="keyword">val</span> get_string : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> string</code></dt><dd><p><code>get_string t</code> returns the next argument (which must be a string) from <code>t</code> and advances the next-argument pointer. The string returned does not include the trailing <code>'\0'</code>.</p></dd></dl><dl><dt class="spec value" id="val-get_string_opt"><a href="#val-get_string_opt" class="anchor"></a><code><span class="keyword">val</span> get_string_opt : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>get_string_opt t</code> returns the next argument (which must be a string or NULL) from <code>t</code> and advances the next-argument pointer. The string returned does not include the trailing <code>'\0'</code>.</p></dd></dl><dl><dt class="spec value" id="val-get_array"><a href="#val-get_array" class="anchor"></a><code><span class="keyword">val</span> get_array : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> string</code></dt><dd><p><code>get_array t</code> returns the next argument (which must be array) from <code>t</code> and advances the next-argument pointer.</p></dd></dl><dl><dt class="spec value" id="val-get_fd"><a href="#val-get_fd" class="anchor"></a><code><span class="keyword">val</span> get_fd : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> Unix.file_descr</code></dt><dd><p><code>get_fd t</code> takes the next FD from the queue. It raises an exception if the queue is empty. Note that the Wayland protocol does not indicate which FDs below to which messages, so if used incorrectly this will remove FDs intended for other messages. The caller takes ownership of the FD and is responsible for closing it.</p></dd></dl><dl><dt class="spec value" id="val-get_fixed"><a href="#val-get_fixed" class="anchor"></a><code><span class="keyword">val</span> get_fixed : <span><span>(<span class="type-var">_</span>, <span class="type-var">_</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="../Wayland/Fixed/index.html#type-t">Wayland.Fixed.t</a></code></dt><dd><p><code>get_fixed t</code> returns the next argument (which must be a fixed-point number) from <code>t</code> and advances the next-argument pointer.</p></dd></dl></section><section><header><h3 id="generating-messages"><a href="#generating-messages" class="anchor"></a>Generating messages</h3></header><dl><dt class="spec value" id="val-alloc"><a href="#val-alloc" class="anchor"></a><code><span class="keyword">val</span> alloc : <span>obj:int32</span> <span>&#45;&gt;</span> <span>op:int</span> <span>&#45;&gt;</span> <span>ints:int</span> <span>&#45;&gt;</span> <span>strings:<span><span>string option</span> list</span></span> <span>&#45;&gt;</span> <span>arrays:<span>string list</span></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span>[ `W ]</span>)</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>See <span class="xref-unresolved" title="unresolved reference to &quot;Proxy.alloc&quot;"><code>Proxy</code>.alloc</span>.</p></dd></dl><dl><dt class="spec value" id="val-add_int"><a href="#val-add_int" class="anchor"></a><code><span class="keyword">val</span> add_int : <span><span>(<span class="type-var">_</span>, <span>[ `W ]</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_string"><a href="#val-add_string" class="anchor"></a><code><span class="keyword">val</span> add_string : <span><span>(<span class="type-var">_</span>, <span>[ `W ]</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_string_opt"><a href="#val-add_string_opt" class="anchor"></a><code><span class="keyword">val</span> add_string_opt : <span><span>(<span class="type-var">_</span>, <span>[ `W ]</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>string option</span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_array"><a href="#val-add_array" class="anchor"></a><code><span class="keyword">val</span> add_array : <span><span>(<span class="type-var">_</span>, <span>[ `W ]</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_fd"><a href="#val-add_fd" class="anchor"></a><code><span class="keyword">val</span> add_fd : <span><span>(<span class="type-var">_</span>, <span>[ `W ]</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> Unix.file_descr <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_fd t fd</code> adds a copy of <code>fd</code> (made with <code>Unix.dup</code>) to the message.</p></dd></dl><dl><dt class="spec value" id="val-add_fixed"><a href="#val-add_fixed" class="anchor"></a><code><span class="keyword">val</span> add_fixed : <span><span>(<span class="type-var">_</span>, <span>[ `W ]</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="../Wayland/Fixed/index.html#type-t">Wayland.Fixed.t</a> <span>&#45;&gt;</span> unit</code></dt></dl></section></div></body></html>